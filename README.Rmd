---
output: github_document
---
<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/",
  out.width = "100%"
)
```

# greenfeedr <img src="man/figures/GFSticker.png" align="right" width="10%"/>

<!-- badges: start -->
[![R-CMD-check](https://github.com/GMBog/greenfeedr/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/GMBog/greenfeedr/actions/workflows/R-CMD-check.yaml)
<!-- badges: end -->

The goal of greenfeedr is to provide functions for downloading, processing, and reporting GreenFeed data

## Installation

You can install the development version of greenfeedr from [GitHub](https://github.com/GMBog/greenfeedr) with:

``` r
# install.packages("pak")
pak::pak("GMBog/greenfeedr")
```

## Example

```{r setup, message=FALSE, warning=FALSE}
library(greenfeedr)
library(ggplot2)
library(dplyr)
```

This is a basic example which shows you how to work with GreenFeed files:

```{r example, message=FALSE, warning=FALSE}
# Define file paths for example data
## Example data contains 62 dairy cows from a study using one GreenFeed unit
file1 <- system.file("extdata", "StudyName_GFdata.csv", package = "greenfeedr")

# Here you can evaluate the use of different parameters to process the data
# let's check the number of cows we retain when we use param2 = 3 or 4 and min_time = 2 or 3

# Run the function process_gfdata() and create two objects data11 and data12:
data32 <- process_gfdata(file1,
  input_type = "daily",
  start_date = "2024-05-13",
  end_date = "2024-05-25",
  param1 = 2,
  param2 = 3,
  min_time = 2
)

data43 <- process_gfdata(file1,
  input_type = "daily",
  start_date = "2024-05-13",
  end_date = "2024-05-25",
  param1 = 2,
  param2 = 4,
  min_time = 3
)

# Then check the number of cows from each returned data sets:
cat("If we use 3 days with records per week (=param2) and a minimum time of 2 minutes (=min_time), we keep: ", nrow(data32$daily_data), "in data")
cat("Otherwise, if we use 4 days with records per week (=param2) and a minimum time of 3 minutes (=min_time), we keep: ", nrow(data43$daily_data), "in data")
cat("Ohhh that means we remove half of the cows in the study, due to the parameters defined in data processing")


# Now, let's check the difference between process daily and final data.
## First note that here we defined the End_Date because we want to process all data from a completed study for which received the final report from C-Lock.

## Example data contains the final report from the same 62 dairy cows from a study using one GreenFeed unit
file2 <- system.file("extdata", "StudyName_FinalReport.xlsx", package = "greenfeedr")

# Run the function process_gfdata() and create one object finaldata:
finaldata <- process_gfdata(file2,
  input_type = "final",
  start_date = "2024-05-13",
  end_date = "2024-05-25",
  param1 = 2,
  param2 = 3,
  min_time = 2
)

head(finaldata)
```


